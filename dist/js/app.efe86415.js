(function(e){function t(t){for(var o,s,c=t[0],a=t[1],l=t[2],d=0,m=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&m.push(r[s][0]),r[s]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,s=1;s<n.length;s++){var a=n[s];0!==r[a]&&(o=!1)}o&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var o={},r={app:0},i=[];function s(e){return c.p+"js/"+({Blog:"Blog"}[e]||e)+"."+{Blog:"528f655e"}[e]+".js"}function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,o){n=r[e]=[t,o]}));t.push(n[2]=o);var i,a=document.createElement("script");a.charset="utf-8",a.timeout=120,c.nc&&a.setAttribute("nonce",c.nc),a.src=s(e);var l=new Error;i=function(t){a.onerror=a.onload=null,clearTimeout(d);var n=r[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",l.name="ChunkLoadError",l.type=o,l.request=i,n[1](l)}r[e]=void 0}};var d=setTimeout((function(){i({type:"timeout",target:a})}),12e4);a.onerror=a.onload=i,document.head.appendChild(a)}return Promise.all(t)},c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="dist/",c.oe=function(e){throw console.error(e),e};var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var u=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"Blog",(function(){return T})),n.d(o,"BlogFeed",(function(){return R})),n.d(o,"BlogPost",(function(){return L}));var r=n("7a23");const i=!0,s=Object(r["h"])("div",{class:"test"},null,-1);function c(e,t,n,o,i,c){const a=Object(r["s"])("router-view");return Object(r["n"])(),Object(r["g"])(r["a"],null,[Object(r["j"])(a),s],64)}var a={name:"App",setup(){return{name:"111"}}},l=n("6b0d"),d=n.n(l);const u=d()(a,[["render",c]]);var m=u,h=(n("7dc4"),{inserted:e=>{function t(){const t=Array.from(e.children).find(e=>"IMG"===e.nodeName);t&&(t.addEventListener("load",()=>{setTimeout(()=>e.classList.add("loaded"),100)}),t.addEventListener("error",()=>console.log("error")),t.src=t.dataset.url)}function n(n,o){n.forEach(n=>{n.isIntersecting&&(t(),o.unobserve(e))})}function o(){const t={root:null,threshold:"0"},o=new IntersectionObserver(n,t);o.observe(e)}window.IntersectionObserver?o():t()}}),p=(n("14d9"),n("dea4"));class g{constructor(){this.events={}}$emit(e,...t){this.events[e]&&this.events[e].forEach(e=>{"function"===typeof e&&e(...t)})}$on(e,t){this.events[e]?this.events[e].push(t):this.events[e]=[t]}$off(e,t){this.events[e]&&(t?this.events[e].forEach((n,o)=>{n===t&&this.events[e].splice(o,1)}):delete this.events[e])}}var f=g,b=new f;function v(e,t,n,o,i,s){const c=Object(r["s"])("comments-overlay");return Object(r["n"])(),Object(r["g"])("div",null,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["r"])(s.targets,e=>(Object(r["n"])(),Object(r["e"])(c,{target:e,key:e.id,onCreate:o.onCreate,onEdit:o.onEdit,onRemove:o.onRemove},null,8,["target","onCreate","onEdit","onRemove"]))),128))])}const O={class:"comments-overlay"},j=["onClick"],y={key:1,class:"comments-overlay__form"},w=["disabled"],x=["disabled"];function C(e,t,n,o,i,s){return Object(r["n"])(),Object(r["g"])("div",O,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["r"])(n.target.comments,e=>(Object(r["n"])(),Object(r["g"])("div",{class:"comments-overlay__container",key:e.id,style:Object(r["m"])(s.getCommentPostition(e))},[i.editting!=e?(Object(r["n"])(),Object(r["g"])("button",{key:0,class:"comments-overlay__indicator",onClick:t=>s.onIndicatorClick(e)},Object(r["u"])(e.commenter.initials),9,j)):(Object(r["n"])(),Object(r["g"])("div",y,[Object(r["h"])("p",null,Object(r["u"])(s.getCommentMetaString(e)),1),Object(r["x"])(Object(r["h"])("textarea",{ref_for:!0,ref:"text","onUpdate:modelValue":t[0]||(t[0]=e=>i.text=e)},null,512),[[r["v"],i.text]]),Object(r["h"])("button",{onClick:t[1]||(t[1]=(...e)=>s.edit&&s.edit(...e)),disabled:!i.text},"Save",8,w),Object(r["h"])("button",{onClick:t[2]||(t[2]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel"),Object(r["h"])("button",{onClick:t[3]||(t[3]=(...e)=>s.remove&&s.remove(...e))},"Remove")]))],4))),128)),i.creating?(Object(r["n"])(),Object(r["g"])("div",{key:0,class:"comments-overlay__form",style:Object(r["m"])(s.getCommentPostition(i.creating))},[Object(r["x"])(Object(r["h"])("textarea",{ref:"text","onUpdate:modelValue":t[4]||(t[4]=e=>i.text=e)},null,512),[[r["v"],i.text]]),Object(r["h"])("button",{onClick:t[5]||(t[5]=(...e)=>s.create&&s.create(...e)),disabled:!i.text},"Save",8,x),Object(r["h"])("button",{onClick:t[6]||(t[6]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel")],4)):Object(r["f"])("",!0)])}var _={props:["target"],data(){return{text:null,editting:null,creating:null}},methods:{onTargetClick(e){console.log(e),this._resetState();const t=this.target.getRect();this.creating={id:e.id,targetId:this.target.id,commenter:e.commenter,ratioX:(e.clientX-t.left)/t.width,ratioY:(e.clientY-t.top)/t.height}},onIndicatorClick(e){this._resetState(),this.text=e.text,this.editting=e},getCommentPostition(e){const t=this.target.getRect(),n=e.ratioX*t.width+t.left,o=e.ratioY*t.height+t.top;return{left:n+"px",top:o+"px"}},getCommentMetaString(e){return"string"===typeof e.timestamp&&(e.timestamp=new Date(e.timestamp)),`${e.commenter.fullName} - ${e.timestamp.getMonth()+1}/${e.timestamp.getDate()}/${e.timestamp.getFullYear()}`},edit(){this.editting.text=this.text,this.editting.timestamp=new Date,this._emit("edit",this.editting),this._resetState()},create(){this.creating.text=this.text,this.creating.timestamp=new Date,this._emit("create",this.creating),this._resetState()},cancel(){this._resetState()},remove(){this._emit("remove",this.editting),this._resetState()},_emit(e,t){this.$emit(e,t)},_resetState(){this.text=null,this.editting=null,this.creating=null}},beforeMount(){console.log(this.target.id),this.$nextTick(()=>{b.$on("commentTargetClicked__"+this.target.id,e=>{this.onTargetClick(e)})})},beforeUnmount(){b.$off("commentTargetClicked__"+this.target.id,this.onTargetClick)}};n("995b");const k=d()(_,[["render",C],["__scopeId","data-v-09e93054"]]);var S=k,E={components:{CommentsOverlay:S},setup(e,{emit:t}){const n=e=>{t("create",e)},o=e=>{t("edit",e)},r=e=>{t("remove",e)};return{onCreate:n,onEdit:o,onRemove:r}},computed:{targets(){return this.$root.targets}},emits:["create","edit","remove"]};const $=d()(E,[["render",v]]);var P=$;const I={commenterSelector(){return{id:null,fullName:"Anonymous",initials:"--",email:null}}};var M={install:(e,t)=>{const n=Object(r["q"])({targets:{}}),o={...I,...t},i=Object(r["d"])({name:"CommentsRoot",setup(){return{...n}},render:()=>Object(r["k"])(P,{onCreate:e=>n.targets[e.targetId].comments.push(e),onEdit:e=>{const t=n.targets[e.targetId].comments;t.splice(t.indexOf(e),1,e)},onRemove:e=>{console.log(e);const t=n.targets[e.targetId].comments;console.log(t.indexOf(e)),t.splice(t.indexOf(e),1)}})});i.mount(document.body.appendChild(document.createElement("div"))),e.directive("comments-enabled",{mounted(e,t){n.targets[t.value]={id:t.value,comments:[],getRect:()=>e.getBoundingClientRect()},e.addEventListener("click",e=>{b.$emit("commentTargetClicked__"+t.value,{id:Object(p["d"])(),commenter:o.commenterSelector(),clientX:e.clientX,clientY:e.clientY})})}})}},T={blog(){return{path:"/blog.json",resolve:(e,t)=>{const n=e.results[0];return t.merge({title:n.title,labels:{post:n.post_label,author:n.author_label}})}}}},R={feed(){return{path:"/feed.json",resolve:(e,t)=>t.pipe(e.results)}}},L={post(e){return{path:`/post/${e}.json`,resolve:(e,t)=>{let{title:n,content:o,meta:r}=e.results[0];return o="<p>"+o.split("\n\n").join("</p><p>")+"</p>",t.merge({title:n,content:o,...r})}}}},B=(()=>{const e={};return{has:t=>!!e[t],get:t=>JSON.parse(e[t]),set:(t,n)=>(e[t]=JSON.stringify(n),Promise.resolve(n))}})(),A=n("da81"),N=n.n(A),Y={install(e,{endpoint:t="",resources:n={}}){e.config.globalProperties.$getResource=function(e,o){const r=this.$options.resource;if(!r||!n[r]||!n[r][e])return;const{path:i,resolve:s}=n[r][e](o),c=t+i,a={pipe:e=>Promise.resolve(e),merge:e=>(N()(this.$data,e),Promise.resolve(e)),set:e=>(Object.keys(e).forEach(t=>{this.$set(this.$data,t,e[t])}),Promise.resolve(e))};return B.has(c)?s(B.get(c),a):fetch(c).then(e=>e.json()).then(e=>B.set(c,e)).then(e=>s(e,a))}}};const z=()=>{const e=[];let t=!0;const n=(()=>{const e=document.createElement("div"),t=document.createElement("style");return e.id="match-media-node",t.innerHTML="#match-media-node {\n      width: 100%;\n      height: 100%;\n      position: absolute;\n      bottom: 100%;\n      overflow: scroll;\n    }",document.head.appendChild(t),document.body.insertBefore(e,document.body.children[0]),{get width(){return e.clientWidth},get height(){return e.clientHeight},get orientation(){return e.clientHeight>e.clientWidth?"portrait":"landscape"},get fontSize(){return window.getComputedStyle(document.documentElement).getPropertyValue("font-size")}}})(),o=(e,t)=>{if("orientation"===e)return()=>t===n.orientation;const[o,r]=e.split("-").reverse(),i=r?"min"===r?"<":">":"==",s=(()=>~t.indexOf("em")?()=>parseFloat(t)*n.fontSize:()=>parseFloat(t))(),c={width:()=>s()+i+n.width,height:()=>s()+i+n.height};return c[o]},r=e=>{const[t,n]=e.replace(/[()\s]/g,"").split(":");return o(t,n)};return window.addEventListener("resize",()=>{if(!t)return;t=!1;let o=n.width,r=n.height;const i=setInterval(()=>{o!==n.width||r!==n.height?(o=n.width,r=n.height):(clearTimeout(i),e.forEach(e=>e()),t=!0)},100)}),t=>{const n=r(t),o={get matches(){return n()}};return{...o,addListener(t){const n=()=>t(o);e.push(n)}}}},D=window.matchMedia||z();var F={install(e,t){const n=Object(r["q"])({devices:{}}),o=(e,t)=>(n.devices[e]=t,({matches:t})=>{n.devices[e]=t});Object.keys(t).forEach(e=>{const n=D(`(${t[e]})`),r=o(e,n.matches);n.addListener(r)}),e.config.globalProperties.$device=n.devices}},V=n("6605");const X=()=>n.e("Blog").then(n.bind(null,"2d33")),q=[{path:"/",name:"feed",component:X},{path:"/by/:author",name:"author",props:!0,component:X},{path:"/read/:post",name:"post",props:!0,component:X}],J=Object(V["a"])({history:Object(V["b"])(),linkActiveClass:"active",routes:q});var U=J;const H=Object(r["d"])({render:()=>Object(r["k"])(m),mounted(){window.rootVue=this}});H.use(U),H.use(M,{commenterSelector(){return{id:Object(p["d"])(),fullName:"Magic "+Math.random().toString(16).slice(2),initials:"SMILE",email:"young@goldmorning.cn"}}}),H.use(Y,{resources:o,endpoint:i?"./dist/static/api":"./static/api"}),H.use(F,{phone:"max-width: 567px",tablet:"min-width: 568px",mobile:"max-width: 1024px",laptop:"min-width: 1025px",desktop:"min-width: 1280px",monitor:"min-width: 1448px"}),H.directive("lazyload",h),H.mount("#app")},"7dc4":function(e,t,n){},"995b":function(e,t,n){"use strict";n("ef2e")},dea4:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));n("907a"),n("986a"),n("1d02"),n("3c5d");function o(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}const r=e=>e.toLowerCase().replace(" ","-"),i=e=>new Date(e).toString().split(" ").slice(0,4).join(" ").replace(/( \d+)$/,",$1"),s=function(e,t,n,o=1.2){if(e===t||e<t)return!1;let r=0;r=e<t?t-e:e-t;const i=function(){if(r=parseInt(r/o),r<1)return n(r,!1),0;n(r),requestAnimationFrame(i)};i()}},ef2e:function(e,t,n){}});
//# sourceMappingURL=app.efe86415.js.map